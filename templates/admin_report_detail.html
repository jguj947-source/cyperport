{% extends "base.html" %}

{% block title %}تفاصيل التقرير - بوابة الأمن السيبراني{% endblock %}

{% block content %}
<section class="section container">
    <div style="max-width: 800px; margin: 0 auto;">
        <a href="{{ url_for('admin_reports') }}" style="color: var(--primary-color); text-decoration: none;">← العودة للتقارير</a>
        
        <div style="background-color: white; padding: 2rem; border-radius: 0.5rem; margin-top: 1.5rem;">
            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1.5rem;">
                <div>
                    <h1 style="margin-bottom: 0.5rem;">{{ report['title'] }}</h1>
                    <p style="color: var(--text-light);">من: {{ report['full_name'] }} ({{ report['email'] }})</p>
                    <p style="color: var(--text-light);">{{ report['created_at'] }}</p>
                </div>
                <span style="background-color: 
                    {% if report['status'] == 'new' %}var(--warning-color)
                    {% elif report['status'] == 'in_review' %}var(--primary-color)
                    {% else %}var(--success-color)
                    {% endif %};
                    color: white; padding: 0.5rem 1rem; border-radius: 0.25rem;">
                    {% if report['status'] == 'new' %}جديد
                    {% elif report['status'] == 'in_review' %}قيد المراجعة
                    {% else %}مغلق
                    {% endif %}
                </span>
            </div>
            
            <div style="margin-bottom: 1.5rem; padding-bottom: 1.5rem; border-bottom: 1px solid var(--border-color);">
                <h3 style="margin-bottom: 0.5rem;">المعلومات</h3>
                <p><strong>النوع:</strong> {{ report['report_type'] }}</p>
            </div>
            
            <div style="margin-bottom: 1.5rem; padding-bottom: 1.5rem; border-bottom: 1px solid var(--border-color);">
                <h3 style="margin-bottom: 0.5rem;">الوصف</h3>
                <p>{{ report['description'] }}</p>
            </div>
            
            {% if report['file_path'] %}
            <div style="margin-bottom: 1.5rem; padding-bottom: 1.5rem; border-bottom: 1px solid var(--border-color);">
                <h3 style="margin-bottom: 0.5rem;">الملف المرفق</h3>
                <a href="{{ url_for('static', filename=report['file_path']) }}" class="btn btn-secondary btn-sm" download>تحميل الملف</a>
            </div>
            {% endif %}
            
            <div style="margin-bottom: 1.5rem;">
                <h3 style="margin-bottom: 1rem;">تحديث الحالة</h3>
                <form method="POST" action="{{ url_for('update_report_status', report_id=report['id']) }}" style="display: flex; gap: 1rem;">
                    <select name="status" required>
                        <option value="new" {% if report['status'] == 'new' %}selected{% endif %}>جديد</option>
                        <option value="in_review" {% if report['status'] == 'in_review' %}selected{% endif %}>قيد المراجعة</option>
                        <option value="closed" {% if report['status'] == 'closed' %}selected{% endif %}>مغلق</option>
                    </select>
                    <button type="submit" class="btn btn-primary">تحديث</button>
                </form>
            </div>
        </div>
    </div>
</section>
{% endblock %}
