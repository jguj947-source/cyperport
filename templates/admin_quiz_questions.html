{% extends "base.html" %}

{% block title %}{% if lang == 'en' %}Manage Questions{% else %}إدارة الأسئلة{% endif %} - {% if lang == 'en' %}Cybersecurity Portal{% else %}بوابة الأمن السيبراني{% endif %}{% endblock %}

{% block content %}
<section class="section container">
    <div style="max-width: 900px; margin: 0 auto;">
        <a href="{{ url_for('admin_quizzes') }}" style="color: var(--primary-color); text-decoration: none;">← {% if lang == 'en' %}Back to Quizzes{% else %}العودة للاختبارات{% endif %}</a>
        
        <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 1rem; margin-bottom: 2rem;">
            <h2>{% if lang == 'en' %}Questions for: {{ quiz['title_en'] }}{% else %}أسئلة الاختبار: {{ quiz['title_ar'] }}{% endif %}</h2>
            <a href="{{ url_for('admin_new_question', quiz_id=quiz['id']) }}" class="btn btn-primary">{% if lang == 'en' %}New Question{% else %}سؤال جديد{% endif %}</a>
        </div>
        
        {% if questions_data %}
        <div>
            {% for item in questions_data %}
            {% set question = item['question'] %}
            {% set options = item['options'] %}
            <div style="background-color: white; padding: 1.5rem; margin-bottom: 1rem; border-radius: 0.5rem; border-left: 4px solid var(--primary-color);">
                <div style="display: flex; justify-content: space-between; align-items: start;">
                    <div style="flex: 1;">
                        <h4 style="margin-bottom: 0.5rem;">
                            {% if lang == 'en' %}{{ question['question_en'] }}{% else %}{{ question['question_ar'] }}{% endif %}
                        </h4>
                        <ul style="list-style: none; padding: 0; margin-top: 1rem;">
                            {% for option in options %}
                            <li style="padding: 0.25rem 0; {% if loop.index0 == question['correct_option'] %}font-weight: bold; color: var(--success-color);{% endif %}">
                                {% if loop.index0 == question['correct_option'] %}✅{% else %}☐{% endif %} 
                                {% if lang == 'en' %}{{ option['option_en'] }}{% else %}{{ option['option_ar'] }}{% endif %}
                            </li>
                            {% endfor %}
                        </ul>
                    </div>
                    <div style="display: flex; gap: 0.5rem;">
                        <a href="{{ url_for('admin_edit_question', quiz_id=quiz['id'], question_id=question['id']) }}" class="btn btn-secondary btn-sm">{% if lang == 'en' %}Edit{% else %}تعديل{% endif %}</a>
                        <form method="POST" action="{{ url_for('admin_delete_question', quiz_id=quiz['id'], question_id=question['id']) }}" style="display: inline;">
                            <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('{% if lang == 'en' %}Are you sure you want to delete this question?{% else %}هل أنت متأكد من حذف هذا السؤال؟{% endif %}');">{% if lang == 'en' %}Delete{% else %}حذف{% endif %}</button>
                        </form>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <div style="text-align: center; padding: 3rem;">
            <p style="color: var(--text-light); margin-bottom: 1.5rem;">{% if lang == 'en' %}No questions found for this quiz.{% else %}لا توجد أسئلة لهذا الاختبار.{% endif %}</p>
            <a href="{{ url_for('admin_new_question', quiz_id=quiz['id']) }}" class="btn btn-primary">{% if lang == 'en' %}Add First Question{% else %}إضافة أول سؤال{% endif %}</a>
        </div>
        {% endif %}
    </div>
</section>
{% endblock %}
